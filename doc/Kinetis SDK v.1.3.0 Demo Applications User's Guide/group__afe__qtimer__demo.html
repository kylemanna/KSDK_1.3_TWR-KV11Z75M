<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Kinetis SDK v.1.3 Demo Applications User&#39;s Guide: AFE Qtimer Demo</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="fs_logo.gif"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Kinetis SDK v.1.3 Demo Applications User&#39;s Guide
   &#160;<span id="projectnumber">Rev. 0</span>
   </div>
   <div id="projectbrief">Freescale Semiconductor, Inc.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>API&#160;Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__afe__qtimer__demo.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">AFE Qtimer Demo</div>  </div>
</div><!--header-->
<div class="contents">
<p>This demo application demonstrates two AFE channels sampling external analog signals and one channel can monitor AC signal's frequency.</p>
<h1><a class="anchor" id="Ovw"></a>
Overview</h1>
<p>The AFE Qtimer Demo project is a demonstration program that uses the KSDK software. It implements the following features:</p>
<ul>
<li>Two AFE channels(channel 2&amp;3) sample external analog signals.</li>
<li>If the external analog signal is AC signal, with internal CMP1 and Qtimer0, one AFE channel(channel 2) can also monitor the external signal's frequency. This is typical use case to monitor the grid frequency(e.g., 50 Hz) in metering field.</li>
<li>By default users use debug console to output AFE channel values sampling and frequency monitoring.</li>
<li>Implement Freemaster interface on this demo, users can use Freemaster GUI to check the result as another option.</li>
<li>Freemaster download: <a href="http://www.freescale.com/webapp/sps/download/license.jsp?colCode=FMASTERSW&location=null&fsrch=1&sr=6&pageNum=1&Parent_nodeId=&Parent_pageType=">http://www.freescale.com/webapp/sps/download/license.jsp?colCode=FMASTERSW&amp;location=null&amp;fsrch=1&amp;sr=6&amp;pageNum=1&amp;Parent_nodeId=&amp;Parent_pageType=</a></li>
</ul>
<h1><a class="anchor" id="SP"></a>
Supported Platforms</h1>
<p>This Tower System module is supported by the KSDK AFE Qtimer demo.</p>
<ul>
<li>TWR-KM34Z75M</li>
</ul>
<h1><a class="anchor" id="GS"></a>
Getting Started</h1>
<h2><a class="anchor" id="HS"></a>
Hardware Settings</h2>
<ul>
<li>Use external power supply to input DC analog signals to AFE channel 2&amp;3(J31 pin10/12/14/16),AFE sample can support both single-ended or differential mode;</li>
</ul>
<div> <table class="doxtable">
<tr>
<td colspan="1" align="center" bgcolor="#2E9AFE">Board </td><td colspan="1" align="center" bgcolor="#2E9AFE">Connects To </td><td colspan="1" align="center" bgcolor="#2E9AFE">DC Power Supply  </td></tr>
<tr>
<td align="center">AFE Channel 2 EXT_SD_ADP2 J31 pin10 </td><td align="center">-&gt; </td><td align="center">DC Power source 1 positive end  </td></tr>
<tr>
<td align="center">AFE Channel 2 EXT_SD_ADM2 J31 pin12 </td><td align="center">-&gt; </td><td align="center">DC Power source 1 negative end  </td></tr>
<tr>
<td align="center">AFE Channel 3 EXT_SD_ADP3 J31 pin14 </td><td align="center">-&gt; </td><td align="center">DC Power source 2 positive end  </td></tr>
<tr>
<td align="center">AFE Channel 3 EXT_SD_ADM3 J31 pin16 </td><td align="center">-&gt; </td><td align="center">DC Power source 2 negative end  </td></tr>
</table>
</div><ul>
<li>To monitor frequency, use a signal generator to input the AC sine signal to the AFE channel 2(J31 pin10/12).</li>
</ul>
<div> <table class="doxtable">
<tr>
<td colspan="1" align="center" bgcolor="#2E9AFE">Board </td><td colspan="1" align="center" bgcolor="#2E9AFE">Connects To </td><td colspan="1" align="center" bgcolor="#2E9AFE">Signal Generator  </td></tr>
<tr>
<td align="center">AFE Channel 2 EXT_SD_ADP2 J31 pin10 </td><td align="center">-&gt; </td><td align="center">Signal Generator positive end  </td></tr>
<tr>
<td align="center">AFE Channel 2 EXT_SD_ADM2 J31 pin12 </td><td align="center">-&gt; </td><td align="center">Signal Generator negative end  </td></tr>
</table>
</div><h2><a class="anchor" id="PtD"></a>
Prepare the Demo</h2>
<ol type="1">
<li>Connect a USB cable between the PC host and the OpenSDA USB port on the board.</li>
<li>Open a serial terminal with these settings:<ul>
<li>115200 baud rate</li>
<li>8 data bits</li>
<li>No parity</li>
<li>One stop bit</li>
<li>No flow control</li>
</ul>
</li>
<li>Download the program to the target board.</li>
<li>Either press the reset button on your board or launch the debugger in your IDE to begin running the example.</li>
</ol>
<h2><a class="anchor" id="RtD"></a>
Run the demo</h2>
<p>1.AFE two channels voltage sampling</p>
<ul>
<li>Use the DC power supply to input the two external signals from 0~500 mV to AFE channel 2&amp;3. The converted values (value_ch2 and value_ch3) change with the external input on the debug console.</li>
</ul>
<p>2.External AC signal frequency monitoring.</p>
<ul>
<li>Use a signal generator to input one sine waveform signal (e.g., Amplitude=500 mV,Offset=0 mV, Frequency=50 Hz) to AFE channel 2. The frequency value is captured by the "freq_tmr" variable on the debug console. The AC signal frequency ranges between about 25 Hz~1000 Hz. The recommended input value is the 50 Hz for the grid frequency simulation.</li>
</ul>
<p>The printed log is displayed in the terminal window as shown below.</p>
<div class="fragment"><div class="line">value_ch2 = 0xffbe5eb0</div>
<div class="line">value_ch3 = 0x13d28</div>
<div class="line">freq_tmr = 50.0</div>
<div class="line">value_ch2 = 0xffbe56ea</div>
<div class="line">value_ch3 = 0x15a3e</div>
<div class="line">freq_tmr = 49.975</div>
<div class="line">value_ch2 = 0xffbe5567</div>
<div class="line">value_ch3 = 0x15893</div>
<div class="line">freq_tmr = 50.1</div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.5-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul class="foot">
    <li class="footer">Wed Nov 11 2015 &copy; 2015 Freescale Semiconductor, Inc. All rights reserved.
    </li>
  </ul>
</div>
</body>
</html>
