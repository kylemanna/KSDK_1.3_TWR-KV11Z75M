<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Kinetis SDK v.1.3 API Reference Manual: FlexIO I2S peripheral driver</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="fs_logo.gif"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Kinetis SDK v.1.3 API Reference Manual
   &#160;<span id="projectnumber">Rev. 0</span>
   </div>
   <div id="projectbrief">Freescale Semiconductor, Inc.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>API&#160;Reference</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__flexio__i2s__driver.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">FlexIO I2S peripheral driver<div class="ingroups"><a class="el" href="group__flexio__i2s.html">FlexIO-simulated I2S (FlexIO_I2S)</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<p>This section describes the programming interface of the FlexIO I2S Peripheral driver. The FlexIO I2S Peripheral driver provides functions for a I2S device to send and receive data.</p>
<h1><a class="anchor" id="FlexIOI2SDevS"></a>
FlexIO I2S device structures</h1>
<p>The driver uses an instantiation of the flexio_i2s_handler_t structure to maintain the current state of a particular FlexIO-simulated I2S driver. This structures holds data that is used by the FlexIO-simulated I2S Peripheral driver to communicate between the transmit and receive transfer functions and the interrupt handler. The interrupt handler also uses this information to keep track of its progress. Because the driver itself does not statically allocate memory, the caller provides memory for the driver state structure during initialization by providing a structure.</p>
<h1><a class="anchor" id="FlexIOI2SUsCS"></a>
FlexIO I2S User configuration structures</h1>
<p>The FlexIO-simulated I2S driver uses instances of the user configuration structure flexio_i2s_config_t for the FlexIO-simulated I2S driver. The user settings include: I2S mode(master or slave), sample rate, audio data bit count, FlexIO base pin DMA source and the associated FlexIO timers, shifters, and pin.</p>
<h1><a class="anchor" id="FlexIOI2SInit"></a>
FlexIO I2S Initialization</h1>
<ol>
<li>
To initialize the FlexIO I2S driver, call the FLEXIO_I2S_DRV_Init() function and pass the instance number of the FlexIO peripheral, memory for the run-time state structure, and a pointer to the user configuration structure. For example, to use FlexIO0 pass a value of 0 to the initialization function. </li>
<li>
Then, pass the memory for the run-time state structure. </li>
<li>
Finally, pass a user configuration structure of the type flexio_i2s_config_t. </li>
</ol>
<p>The flexio_i2s_user configuration contents can be easily modified to configure the FlexIO I2S peripheral driver either to a different audio data format or using different FlexIO hardware resource. This is an example code to set up a user FlexIO I2S configuration instantiation:</p>
<div class="fragment"><div class="line">flexio_i2s_config_t i2sConfig;</div>
<div class="line">i2sConfig.data_depth = 16;</div>
<div class="line">i2sConfig.sample_rate = 12000;</div>
<div class="line">i2sConfig.masterslave = kFlexioI2SSlave;</div>
<div class="line">i2sConfig.txPinIdx = 0; <span class="comment">//FlexIO pin0 as transmit data line</span></div>
<div class="line">i2sConfig.rxPinIdx = 1; <span class="comment">//FlexIO pin1 as receive data line</span></div>
<div class="line">i2sConfig.sckPinIdx = 4; <span class="comment">// FlexIO pin4 as SCLK</span></div>
<div class="line">i2sConfig.wsPinIdx = 5; <span class="comment">//FlexIO pin5 as Frame Sync</span></div>
<div class="line">i2sConfig.shifterIdx[0] = 0; <span class="comment">//Use shifter 0 for transmit data</span></div>
<div class="line">i2sConfig.shifterIdx[1] = 1; <span class="comment">// Use shifter 1 for receive data</span></div>
<div class="line">i2sConfig.timerIdx[0] = 0; <span class="comment">// Use Timer0 as SCLK controller.</span></div>
<div class="line">i2sConfig.timerIdx[1] = 1; <span class="comment">// Use Timer1 as Frame Sync controller. </span></div>
</div><!-- fragment --><h1><a class="anchor" id="FlexIOI2SDtrans"></a>
FlexIO I2S Data Transactions</h1>
<p>The driver implements transmit and receive functions to transfer buffers of data in an interrupt and DAM methods. Both interrupt and DMA transfer functions are non-blocking. This code examples shows how to use the functions, assuming that the FLEXIO I2S module has been initialized as described previously in the Initialization Section.</p>
<p>Ensure that data is consistent when there is cache in memory and when using DMA to transfer data. In other words, when reading the data from memory, ensure that data from or to the memory device is not cached.</p>
<p>For blocking transfer functions transmit and receive:</p>
<div class="fragment"><div class="line">uint8_t music[MUSIC_LEN];</div>
<div class="line">FLEXIO_I2S_DRV_SendDataInt(&amp;i2s_handler, (uint8_t *)music, MUSIC_LEN);</div>
<div class="line"><a class="code" href="group__os__abstraction.html#gac620802974e82799bde8d7eeadecaea2">osa_status_t</a> status;</div>
<div class="line"><span class="comment">//Wait for data transfer finished</span></div>
<div class="line"><span class="keywordflow">do</span></div>
<div class="line">{</div>
<div class="line">    status = <a class="code" href="group__os__abstraction.html#ga653fc3e87d91a841348be7b0a0166422">OSA_SemaWait</a>(&amp;(i2s_handler.tx_sem), <a class="code" href="group__os__abstraction__bm.html#ga5c4bbd97efaa670e198fad62038ba771">OSA_WAIT_FOREVER</a>);</div>
<div class="line">}<span class="keywordflow">while</span>(status == <a class="code" href="group__os__abstraction.html#ggac620802974e82799bde8d7eeadecaea2a5ff8ef02cb571d5d5f92a7e816719a3d">kStatus_OSA_Idle</a>);</div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.5-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul class="foot">
    <li class="footer">Thu Sep 24 2015 &copy; 2015 Freescale Semiconductor, Inc. All rights reserved.
    </li>
  </ul>
</div>
</body>
</html>
